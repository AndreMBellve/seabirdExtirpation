---
title: "theoreticalCurves"
author: "André Bellvé"
date: "04/08/2021"
output: html_document
---

```{r Curve graph}
#Seabird colonisation models (theoretical)
library(dplyr)
library(tidyr)
library(ggplot2)
library(ggthemes)
library(wesanderson)
library(scales)


#Curves
dsigmoid <- function(x, curve, halfway){
  return(1 / (1 + (exp((-1 * curve) * (x - halfway)))))
}

#Creating data
theoreticalCurves <- data.frame(n = seq(0.01, 1, by = 0.01)) %>%
  mutate(Uniform = 0.25,#1/nrow(.), - cdf, so consistent very low prob.
         Linear = n/max(n),
         Beta1 = scales::rescale(dbeta(n, shape1 = 5, shape2 = 5)),
         Beta2 = scales::rescale(dbeta(n, shape1 = 5, shape2 = 2)),
         Sigmoid = dsigmoid(n, curve = 15, halfway = 0.5),
         Asymptotic = 1 * (1 - exp(-1 * 8 * n))) %>%
  #mutate(Beta1 = beta / sum(beta)) %>% 
  pivot_longer(cols = c(Uniform, Linear, Beta1, Beta2, 
                        Sigmoid, Asymptotic), values_to = "Probability", names_to = "Distribution") %>% 
  mutate(Distribution = factor(Distribution, levels = c("Uniform", "Linear", "Asymptotic", "Sigmoid", "Beta1", "Beta2")))

#Colour palette (pastel)
pasPal <- qualitative_hcl(6, palette = "dark2") 
  
  
#Plotting
ggplot(theoreticalCurves,
       aes(y = Probability * 100, x = n * 100,
           colour = Distribution)) +
  geom_line(size = 1.25)+
  scale_colour_manual(values = pasPal, guide = FALSE) +
  #scale_colour_colorblind() +
  xlab("Islands Share of Seabirds (%)") +
  ylab("Probability of Settling (%)") +
  facet_wrap(~Distribution) +
  theme_minimal() + 
  theme(axis.title = element_text(size = 16, colour = "white"),
        axis.text =  element_text(size = 14, colour = "white"),
        strip.text = element_text(size = 14, colour = "white"),
        panel.grid = element_blank())

ggsave("./graphs/theoretical_curves.png", height = 7, width = 10)
```

